# flutter-analyze-commenter

Automatically comment Flutter Analyze results in pull requests.

<img width="800" src="https://github.com/yorifuji/flutter-analyze-commenter/assets/583917/2f40f92d-4731-4eb6-98d4-85c8d00998f8">

## Features

- **No External Dependencies**: Runs within GitHub Actions without requiring external tools or plugins.
- **Small Footprint**: Designed to be minimalistic, only doing what is necessary to comment on the PR based on Flutter analyze results.
- **Easy to Use**: Just set the path to your Flutter analyze log file, and the action handles the rest.
- **Customizable Verbosity**: Enable verbose logging to get more detailed output from the action.

## Usage

```yaml
jobs:
  flutter-analyze:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write # required to add comment on PR
    steps:
      # checkout your repository and install flutter

      # run flutter analyze with --write option
      - name: Run flutter analyze
        run: flutter analyze --write=flutter_analyze.log

      # use flutter-analyze-commenter
      - name: Comment PR by flutter-analyze-commenter
        uses: yorifuji/flutter-analyze-commenter@v1
        if: ${{ !cancelled() }}            # run this step even if flutter analyze fails
        with:
          analyze_log: flutter_analyze.log # file path of flutter analyze log
          verbose: true 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　# optional: default is false
```

## How it works

The `flutter-analyze-commenter` GitHub Action leverages `actions/github-script` to interpret and post comments directly within the GitHub Actions workflow. This means there's no need for a separate server or environment to process the results. Instead, the action:

1. Reads the log file generated by `flutter analyze`.
2. Parses the results using a custom JavaScript script within the `actions/github-script` action.
3. Posts comments on the pull request with any issues found, directly through the GitHub API.
4. Ensures that duplicate comments are not posted for unchanged issues and that outdated comments are removed.

By utilizing `actions/github-script`, this action remains within the GitHub Actions environment, making it secure and efficient without the need for additional permissions or setup.

## Known issues

Currently, there are no reported issues. If you encounter any problems, please open an issue in the repository.

# DEVELOPMENT

TBD

## Setup

TBD

## DEBUG

TBD

# LICENSE

MIT
